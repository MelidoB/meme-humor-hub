version: '3.8'

services:
  user-service:
    image: melidob/user-service:latest
    build: ./services/user-service
    ports:
      - "3001:3001"
    environment:
      - DATABASE_URL=sqlite:///data/database.db
      - PORT=3001
    volumes:
      - user-service-data:/app/data  # Named volume for SQLite database
    restart: always

  content-service:
    image: melidob/content-service:latest
    build: ./services/content-service
    ports:
      - "3002:3002"
    volumes:
      - content-service-data:/app/data  # Named volume for SQLite database
    restart: always

  interaction-service:
    image: melidob/interaction-service:latest
    build: ./services/interaction-service
    ports:
      - "3003:3003"
    restart: always

  cache:
    image: redis:latest
    ports:
      - "6379:6379"
    restart: always

  frontend:
    image: melidob/meme-humor-frontend:latest
    build: ./frontend
    ports:
      - "80:80"
    restart: always

volumes:
  user-service-data:
  content-service-data:
